# NFR.md — Таблица требований безопасности

| ID     | Название                    | Описание                                                                                         | Метрика/Порог                                     | Проверка (чем/где)                                  | Компонент      | Приоритет |
|--------|-----------------------------|--------------------------------------------------------------------------------------------------|---------------------------------------------------|------------------------------------------------------|----------------|-----------|
| NFR-01 | Обязательная аутентификация | Все защищённые эндпоинты требуют действительного токена (кроме `/healthz`).                      | 100% защищённых эндпоинтов требуют Auth           | Контракт-тесты Pytest + e2e                          | api/auth       | High      |
| NFR-02 | Авторизация «owner-only»    | Пользователь может работать только со своими Objective/KeyResult.                                | 100% CRUD операций применяют owner-check          | Unit + e2e (negative/positive)                       | api/authz      | High      |
| NFR-03 | Хранение паролей            | Хэширование только Argon2id с параметрами не ниже заданных.                                      | t≥3, m≥256MB, p≥1                                  | Конфиг + unit-тест                                   | auth           | High      |
| NFR-04 | Валидация периода           | `period` (дедлайн) не в прошлом и не далее чем +24 месяца от «сегодня».                          | 100% некорректных дат → 422                       | Unit-тесты FastAPI (pydantic)                        | api/validation | High      |
| NFR-05 | Формат ошибок RFC7807       | Ответы об ошибках в Problem Details + `correlation_id`, без PII.                                 | 100% ошибок RFC7807 + корел.-ID                   | Контракт-тесты + e2e                                 | api            | Medium    |
| NFR-06 | Rate limiting               | Записьные операции ограничены по токену/пользователю.                                            | 100 req/min на токен; превышение → 429            | e2e + нагрузочный smoke                              | api/gateway    | Medium    |
| NFR-07 | Логирование событий         | Логируются security-события (login, create/update/delete, доступ запрещён).                      | ≥ 95% покрытие ключевых событий                   | Unit + e2e; проверка по логам CI                     | audit/logging  | Medium    |
| NFR-08 | Уязвимости зависимостей     | High/Critical устраняются оперативно.                                                            | SLA: ≤ 7 дней с момента детекта                   | CI отчёт pip-audit/SBOM                              | build          | High      |
