| Поток/Элемент          | Угроза (S/T/R/I/D/E) | Описание угрозы                                       | Контроль                                                      | Ссылка на NFR  | Проверка/Артефакт                                            |
| ---------------------- | -------------------- | ----------------------------------------------------- |---------------------------------------------------------------| -------------- |--------------------------------------------------------------|
| F1 (Auth)              | S                    | Кража/подмена токена, использование просроченного JWT | Везде HTTPS; проверка подписи/`exp/nbf/aud/iss` в middleware  | NFR-01         | e2e: доступ без/с просроченным токеном → 401; контракт-тесты |
| F1 (Auth)              | D                    | Брутфорс логина                                       | Rate-limit на аутентификацию; капча (при необходимости)       | NFR-06         | e2e превышение лимита → 429                                  |
| F2 (Edge→SVC)          | S                    | Обход аутентификации через незакрытый маршрут         | Белый список публичных роутов (`/healthz`), остальные за Auth | NFR-01         | Контракт-тесты охвата охраны эндпоинтов                      |
| F2 (Edge→SVC)          | R                    | Отрицание вызовов (нет следов)                        | Корреляционный ID, аудит входящих запросов                    | NFR-07, NFR-05 | Логи CI содержат `correlation_id`; выборка событий           |
| F3 (CRUD /objectives)  | T                    | Тамперинг: подстановка `user_id` в теле               | Игнор `user_id` из тела; user-check по `token.sub`            | NFR-02         | Unit/e2e негатив «создать чужую цель» → 403                  |
| F3 (CRUD /key-results) | T                    | Изменение KR чужой цели                               | Проверка `objective.user_id == token.sub` на всех операциях   | NFR-02         | e2e «чужой KR» → 403                                         |
| F3 (DB)                | T                    | SQL-инъекции через `title/metric`                     | ORM/подготовленные выражения; запрет raw SQL                  | —              | Юнит-тесты инъекций (кавычки/операторы)                      |
| F3 (Validation)        | E                    | Логическая эскалация через невалидный `period`        | Валидация: `period` не в прошлом               | NFR-04         | Unit тест на граничные даты                                  |
| F4 (/stats)            | I                    | Утечка данных другого владельца через агрегации       | Фильтр по владельцу перед агрегациями                         | NFR-02         | e2e: stats видит только свои данные                          |
| F1/F3/F4 (Errors)      | I                    | Утечка внутренних деталей в ошибках                   | RFC7807 без PII, маскирование полей                           | NFR-05         | Контракт-тесты формата ошибок                                |
| F2 (Perimeter)         | D                    | DoS по записьным методам                              | Rate-limit по токену/пользователю на POST/PUT/DELETE          | NFR-06         | e2e: >100 req/min → 429                                      |
| AUD (F5)               | R                    | Неполные логи → возможность отрицания действий        | Логирование allow/deny + CRUD с актором/временем              | NFR-07         | Проверка полноты набора событий в CI                         |
| Supply chain           | T                    | Уязвимые зависимости в рантайме                       | `pip-audit`, SBOM, SLA фикса ≤7 дней                          | NFR-08         | CI отчёт `pip-audit`/SBOM                                    |
